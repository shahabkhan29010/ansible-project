---
- name: Creating & enabling access ports
  hosts:
    - lab-sw03
    - lab-sw04
  gather_facts: no
  connection: network_cli

  tasks:
  - name: Creating access port on leaf switch 03
    when: inventory_hostname == 'lab-sw03'
    cisco.nxos.nxos_l2_interfaces:
      config:
        - name: Ethernet1/7
          access:
            vlan: 10

  - name: Creating access port of leaf switch 04
    when: inventory_hostname == 'lab-sw04'
    cisco.nxos.nxos_l2_interfaces:
      config:
        - name: Ethernet1/7
          access:
            vlan: 20

  - name: Enable the interface
    cisco.nxos.nxos_interfaces:
      config:
        - name: Ethernet1/8
          enabled: true
      state: merged